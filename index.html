<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="pos.css"/>
    <link rel="stylesheet" href="jquery.mobile.icons.min.css"/>
    <link rel="stylesheet" href="jquery.mobile-1.4.5/jquery.mobile-1.4.5.min.css"/>
    <script src="jquery-2.1.4.min.js"></script>
    <script src="jquery.mobile-1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <script src = "cordova.js"></script>
   
</head>
<body>
    <!--<div data-role="page" id="pageone" data-theme="c">
        <div data-role="header">
            <a href="#pageone" data-role="button">Home</a>
            <a href="" data-role="button">Options</a>
            <h1>Tanoe POS</h1>
            <div data-role="navbar">
            </div>
        </div>
        <div role="main" class = "ui-content">
            <form method="post">
                <div data-role="fieldcontain">
                    <label for="username">Username:</label>
                    <input type="text" name="username" id="username"/> 
                    
                    <label for="Password">Password:</label>
                    <input type="text" name="password" id="password"/> 
                    <a href="#pagetwo" data-role="button">login</a>
                    <!--<input type="submit" value="login" id="loginBtn" onclick="login()">
                </div>
            </form>
            
        </div>
        <div data-role="footer">
            <h1>Tanoe Concepts</h1>
        </div>
    </div>-->
    <div data-role="page" id="pageone" data-theme="c">
        <div data-role="header">
            <a href="#pageone" data-role="button">Home</a>
            <a href="" data-role="button">Options</a>
            <h1>Tanoe POS</h1>
            <div data-role="navbar">
            </div>
        </div>
        <div role="main" class = "ui-content">
            <form method="post">
                <div data-role="fieldcontain">
                    <input type="submit" value="Scan" id="scanBtn">
                    <label for="barcodereading">Barcode reading</label>
                    <input type="text" name="barcode" id="barcodereading"/>
                    
                    <label for="productname">Product name</label>
                    <input type="text" name="productname" id="productname"/>
                    
                    <label for="price">Price:</label>
                    <input type="text" name="price" id="price"/>
                    
                    <label for="quantity">Quantity:</label>
                    <input type="text" name="quantity" id="quantity"/>

                   
                    
                   
                    <input type="submit" value="Add Order" id="addorder" onclick="addorder()">
                </div>
            </form>
            
        </div>
        <div data-role="footer">
            <h1>Tanoe Concepts</h1>
        </div>
    </div>
        <div data-role="page" id="pagethree" data-theme="c">
        <div data-role="header">
            <a href="#pageone" data-role="button">Home</a>
            <a href="" data-role="button">Options</a>
            <h1>Tanoe POS</h1>
            <div data-role="navbar">
            </div>
        </div>
        <div role="main" class = "ui-content">
            <form method="post">
                <div data-role="fieldcontain">

                    <label for="customerphone">Customer Phone:</label>
                    <input type="text" name="customerphone" id="customerphone"/> 
                </div>
            </form>
            
        </div>
        <div data-role="footer">
            <h1>Tanoe Concepts</h1>
        </div>
    </div>
    <script type="text/javascript"> 
        function sendRequest(u){
            // Send request to server
            //u a url as a string
            //async is type of request
            var obj=$.ajax({url:u,async:false});
            //Convert the JSON string to object
            var result=$.parseJSON(obj.responseText);
            return result;	//return object	
        }
            
    $(function(){    
        $("scanBtn").click(function(){
    cordova.plugins.barcodeScanner.scan(
      function (result) {
          var str = result.text;
          var price;
          
          $("#barcodereading").text(str);
          
          var url = "http://cs.ashesi.edu.gh/class2016/david-tandoh/MobileWeb/controller.php?cmd=4&barcodereading="+str+"";
          var obj = sendRequest(url);   
          if(obj.result == 1){
              $("#productname").text(obj.stock[0].name);
              $("#price").text(obj.stock[0].price);
              $("#productname").attr("value",obj.stock[0].name);
                 
          alert("We got a barcode\n" +
                "Result: " + result.text + "\n" +
                "Name: " + obj.stock[1].name+ "\n" +
                "Cancelled: " + result.cancelled);
          $("#reading").val(result.text);
          }
            else{
            }
          
         /** alert("We got a barcode\n" +
                "Result: " + result.text + "\n" +
                "Name: " + obj.stock[0].price+ "\n" +
                "Cancelled: " + result.cancelled);
          $("#reading").val(result.text);**/
      }, 
      function (error) {
          alert("Scanning failed: " + error);
      }
   );
});
        
    });
            function addorder(){
            }
            

         
          cordova.plugins.barcodeScanner.encode(cordova.plugins.barcodeScanner.Encode.TEXT_TYPE, "http://www.nytimes.com", function(success) {
            alert("encode success: " + success);
          }, function(fail) {
            alert("encoding failed: " + fail);
          }
        );
        </script>
</body>
</html>